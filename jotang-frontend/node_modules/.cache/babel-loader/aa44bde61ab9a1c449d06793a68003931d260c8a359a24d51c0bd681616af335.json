{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  key: 0\n};\nconst _hoisted_2 = {\n  key: 1,\n  style: {\n    \"color\": \"red\"\n  }\n};\nconst _hoisted_3 = {\n  key: 2\n};\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = {\n  key: 3\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_cache[8] || (_cache[8] = _createElementVNode(\"h2\", null, \"商品列表\", -1 /* CACHED */)), _createVNode(_component_router_link, {\n    to: \"/products/new\",\n    class: \"add-button\"\n  }, {\n    default: _withCtx(() => [...(_cache[4] || (_cache[4] = [_createTextVNode(\"添加新商品\", -1 /* CACHED */)]))]),\n    _: 1 /* STABLE */\n  }), _createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleSearch, [\"prevent\"]),\n    class: \"search-form\"\n  }, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.filters.type = $event),\n    placeholder: \"类型\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.filters.type]]), _withDirectives(_createElementVNode(\"input\", {\n    type: \"number\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.filters.minPrice = $event),\n    placeholder: \"最低价\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.filters.minPrice, void 0, {\n    number: true\n  }]]), _withDirectives(_createElementVNode(\"input\", {\n    type: \"number\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.filters.maxPrice = $event),\n    placeholder: \"最高价\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.filters.maxPrice, void 0, {\n    number: true\n  }]]), _cache[5] || (_cache[5] = _createElementVNode(\"button\", {\n    type: \"submit\"\n  }, \"搜索\", -1 /* CACHED */)), _createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = $event => $setup.loadProducts(true)),\n    type: \"button\"\n  }, \"重置\")], 32 /* NEED_HYDRATION */), $setup.loading ? (_openBlock(), _createElementBlock(\"p\", _hoisted_1, \"正在加载...\")) : _createCommentVNode(\"v-if\", true), $setup.error ? (_openBlock(), _createElementBlock(\"p\", _hoisted_2, _toDisplayString($setup.error), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), $setup.products.length > 0 ? (_openBlock(), _createElementBlock(\"table\", _hoisted_3, [_cache[7] || (_cache[7] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"标题\"), _createElementVNode(\"th\", null, \"类型\"), _createElementVNode(\"th\", null, \"价格\"), _createElementVNode(\"th\", null, \"状态\"), _createElementVNode(\"th\", null, \"操作\")])], -1 /* CACHED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.products, product => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: product.id\n    }, [_createElementVNode(\"td\", null, _toDisplayString(product.title), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(product.type), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(product.price), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(product.status), 1 /* TEXT */), _createElementVNode(\"td\", null, [_createVNode(_component_router_link, {\n      to: {\n        name: 'ProductEdit',\n        params: {\n          id: product.id\n        }\n      }\n    }, {\n      default: _withCtx(() => [...(_cache[6] || (_cache[6] = [_createTextVNode(\"编辑\", -1 /* CACHED */)]))]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"to\"]), _createElementVNode(\"button\", {\n      onClick: $event => $setup.handleDelete(product.id),\n      class: \"delete-button\"\n    }, \"删除\", 8 /* PROPS */, _hoisted_4)])]);\n  }), 128 /* KEYED_FRAGMENT */))])])) : (_openBlock(), _createElementBlock(\"p\", _hoisted_5, \"未找到商品。\"))]);\n}","map":{"version":3,"names":["style","_createElementBlock","_createElementVNode","_createVNode","_component_router_link","to","class","_cache","onSubmit","_withModifiers","$setup","handleSearch","type","filters","$event","placeholder","minPrice","number","maxPrice","onClick","loadProducts","loading","_hoisted_1","error","_hoisted_2","_toDisplayString","products","length","_hoisted_3","_Fragment","_renderList","product","key","id","title","price","status","name","params","handleDelete","_hoisted_4","_hoisted_5"],"sources":["G:\\vue-project\\jotang-frontend\\src\\views\\ProductList.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <h2>商品列表</h2>\r\n    <router-link to=\"/products/new\" class=\"add-button\">添加新商品</router-link>\r\n    \r\n    <form @submit.prevent=\"handleSearch\" class=\"search-form\">\r\n      <input type=\"text\" v-model=\"filters.type\" placeholder=\"类型\">\r\n      <input type=\"number\" v-model.number=\"filters.minPrice\" placeholder=\"最低价\">\r\n      <input type=\"number\" v-model.number=\"filters.maxPrice\" placeholder=\"最高价\">\r\n      <button type=\"submit\">搜索</button>\r\n      <button @click=\"loadProducts(true)\" type=\"button\">重置</button>\r\n    </form>\r\n\r\n    <p v-if=\"loading\">正在加载...</p>\r\n    <p v-if=\"error\" style=\"color: red;\">{{ error }}</p>\r\n\r\n    <table v-if=\"products.length > 0\">\r\n      <thead>\r\n        <tr>\r\n          <th>标题</th>\r\n          <th>类型</th>\r\n          <th>价格</th>\r\n          <th>状态</th>\r\n          <th>操作</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"product in products\" :key=\"product.id\">\r\n          <td>{{ product.title }}</td>\r\n          <td>{{ product.type }}</td>\r\n          <td>{{ product.price }}</td>\r\n          <td>{{ product.status }}</td>\r\n          <td>\r\n            <router-link :to=\"{ name: 'ProductEdit', params: { id: product.id } }\">编辑</router-link>\r\n            <button @click=\"handleDelete(product.id)\" class=\"delete-button\">删除</button>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    <p v-else>未找到商品。</p>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, reactive } from 'vue';\r\nimport apiClient from '@/services/apiClient';\r\n\r\nconst products = ref([]);\r\nconst loading = ref(false);\r\nconst error = ref(null);\r\n\r\nconst filters = reactive({\r\n  type: '',\r\n  minPrice: null,\r\n  maxPrice: null\r\n});\r\n\r\n// 加载所有商品 (GET /products)\r\nconst loadProducts = async (resetFilters = false) => {\r\n  loading.value = true;\r\n  error.value = null;\r\n  if (resetFilters) {\r\n      filters.type = '';\r\n      filters.minPrice = null;\r\n      filters.maxPrice = null;\r\n  }\r\n  try {\r\n    const result = await apiClient('/products', 'GET');\r\n    if (result.code === 1) {\r\n      products.value = result.data;\r\n    } else {\r\n      error.value = result.msg;\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message;\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\n// 搜索 (GET /products/by-condition)\r\nconst handleSearch = async () => {\r\n  loading.value = true;\r\n  error.value = null;\r\n  try {\r\n    // 构建查询参数\r\n    const params = new URLSearchParams();\r\n    if (filters.type) params.append('type', filters.type);\r\n    if (filters.minPrice) params.append('minPrice', filters.minPrice);\r\n    if (filters.maxPrice) params.append('maxPrice', filters.maxPrice);\r\n    \r\n    const endpoint = `/products/by-condition?${params.toString()}`;\r\n    const result = await apiClient(endpoint, 'GET');\r\n\r\n    if (result.code === 1) {\r\n      products.value = result.data;\r\n    } else {\r\n      error.value = result.msg;\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message;\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\n// 删除 (DELETE /products/{id})\r\nconst handleDelete = async (id) => {\r\n  if (!confirm('确定要删除这个商品吗？')) {\r\n    return;\r\n  }\r\n  try {\r\n    const result = await apiClient(`/products/${id}`, 'DELETE');\r\n    if (result.code === 1) {\r\n      // 删除成功后重新加载列表\r\n      loadProducts();\r\n    } else {\r\n      error.value = result.msg;\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message;\r\n  }\r\n};\r\n\r\n// 组件挂载时加载数据\r\nonMounted(loadProducts);\r\n</script>\r\n\r\n<style scoped>\r\n.search-form { margin: 20px 0; background: #f9f9f9; padding: 15px; border-radius: 5px; }\r\n.search-form input, .search-form button { margin-right: 10px; }\r\n.add-button { text-decoration: none; background: #42b983; color: white; padding: 8px 12px; border-radius: 4px; }\r\ntable { width: 100%; border-collapse: collapse; margin-top: 20px; }\r\nth, td { border: 1px solid #ddd; padding: 8px; }\r\nth { background-color: #f4f4f4; }\r\n.delete-button { background: #e74c3c; color: white; border: none; padding: 5px; cursor: pointer; margin-left: 10px; }\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}