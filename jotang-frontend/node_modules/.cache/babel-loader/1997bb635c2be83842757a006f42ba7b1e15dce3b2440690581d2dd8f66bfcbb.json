{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { ref, onMounted, reactive } from 'vue';\nimport apiClient from '@/services/apiClient';\nexport default {\n  __name: 'ProductList',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const products = ref([]);\n    const loading = ref(false);\n    const error = ref(null);\n    const filters = reactive({\n      type: '',\n      minPrice: null,\n      maxPrice: null\n    });\n\n    // 加载所有商品 (GET /products)\n    const loadProducts = async (resetFilters = false) => {\n      loading.value = true;\n      error.value = null;\n      if (resetFilters) {\n        filters.type = '';\n        filters.minPrice = null;\n        filters.maxPrice = null;\n      }\n      try {\n        const result = await apiClient('/products', 'GET');\n        if (result.code === 1) {\n          products.value = result.data;\n        } else {\n          error.value = result.msg;\n        }\n      } catch (err) {\n        error.value = err.message;\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // 搜索 (GET /products/by-condition)\n    const handleSearch = async () => {\n      loading.value = true;\n      error.value = null;\n      try {\n        // 构建查询参数\n        const params = new URLSearchParams();\n        if (filters.type) params.append('type', filters.type);\n        if (filters.minPrice) params.append('minPrice', filters.minPrice);\n        if (filters.maxPrice) params.append('maxPrice', filters.maxPrice);\n        const endpoint = `/products/by-condition?${params.toString()}`;\n        const result = await apiClient(endpoint, 'GET');\n        if (result.code === 1) {\n          products.value = result.data;\n        } else {\n          error.value = result.msg;\n        }\n      } catch (err) {\n        error.value = err.message;\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // 删除 (DELETE /products/{id})\n    const handleDelete = async id => {\n      if (!confirm('确定要删除这个商品吗？')) {\n        return;\n      }\n      try {\n        const result = await apiClient(`/products/${id}`, 'DELETE');\n        if (result.code === 1) {\n          // 删除成功后重新加载列表\n          loadProducts();\n        } else {\n          error.value = result.msg;\n        }\n      } catch (err) {\n        error.value = err.message;\n      }\n    };\n\n    // 组件挂载时加载数据\n    onMounted(loadProducts);\n    const __returned__ = {\n      products,\n      loading,\n      error,\n      filters,\n      loadProducts,\n      handleSearch,\n      handleDelete,\n      ref,\n      onMounted,\n      reactive,\n      get apiClient() {\n        return apiClient;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","reactive","apiClient","products","loading","error","filters","type","minPrice","maxPrice","loadProducts","resetFilters","value","result","code","data","msg","err","message","handleSearch","params","URLSearchParams","append","endpoint","toString","handleDelete","id","confirm"],"sources":["G:/vue-project/jotang-frontend/src/views/ProductList.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <h2>商品列表</h2>\r\n    <router-link to=\"/products/new\" class=\"add-button\">添加新商品</router-link>\r\n    \r\n    <form @submit.prevent=\"handleSearch\" class=\"search-form\">\r\n      <input type=\"text\" v-model=\"filters.type\" placeholder=\"类型\">\r\n      <input type=\"number\" v-model.number=\"filters.minPrice\" placeholder=\"最低价\">\r\n      <input type=\"number\" v-model.number=\"filters.maxPrice\" placeholder=\"最高价\">\r\n      <button type=\"submit\">搜索</button>\r\n      <button @click=\"loadProducts(true)\" type=\"button\">重置</button>\r\n    </form>\r\n\r\n    <p v-if=\"loading\">正在加载...</p>\r\n    <p v-if=\"error\" style=\"color: red;\">{{ error }}</p>\r\n\r\n    <table v-if=\"products.length > 0\">\r\n      <thead>\r\n        <tr>\r\n          <th>标题</th>\r\n          <th>类型</th>\r\n          <th>价格</th>\r\n          <th>状态</th>\r\n          <th>操作</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"product in products\" :key=\"product.id\">\r\n          <td>{{ product.title }}</td>\r\n          <td>{{ product.type }}</td>\r\n          <td>{{ product.price }}</td>\r\n          <td>{{ product.status }}</td>\r\n          <td>\r\n            <router-link :to=\"{ name: 'ProductEdit', params: { id: product.id } }\">编辑</router-link>\r\n            <button @click=\"handleDelete(product.id)\" class=\"delete-button\">删除</button>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    <p v-else>未找到商品。</p>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, reactive } from 'vue';\r\nimport apiClient from '@/services/apiClient';\r\n\r\nconst products = ref([]);\r\nconst loading = ref(false);\r\nconst error = ref(null);\r\n\r\nconst filters = reactive({\r\n  type: '',\r\n  minPrice: null,\r\n  maxPrice: null\r\n});\r\n\r\n// 加载所有商品 (GET /products)\r\nconst loadProducts = async (resetFilters = false) => {\r\n  loading.value = true;\r\n  error.value = null;\r\n  if (resetFilters) {\r\n      filters.type = '';\r\n      filters.minPrice = null;\r\n      filters.maxPrice = null;\r\n  }\r\n  try {\r\n    const result = await apiClient('/products', 'GET');\r\n    if (result.code === 1) {\r\n      products.value = result.data;\r\n    } else {\r\n      error.value = result.msg;\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message;\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\n// 搜索 (GET /products/by-condition)\r\nconst handleSearch = async () => {\r\n  loading.value = true;\r\n  error.value = null;\r\n  try {\r\n    // 构建查询参数\r\n    const params = new URLSearchParams();\r\n    if (filters.type) params.append('type', filters.type);\r\n    if (filters.minPrice) params.append('minPrice', filters.minPrice);\r\n    if (filters.maxPrice) params.append('maxPrice', filters.maxPrice);\r\n    \r\n    const endpoint = `/products/by-condition?${params.toString()}`;\r\n    const result = await apiClient(endpoint, 'GET');\r\n\r\n    if (result.code === 1) {\r\n      products.value = result.data;\r\n    } else {\r\n      error.value = result.msg;\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message;\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\n// 删除 (DELETE /products/{id})\r\nconst handleDelete = async (id) => {\r\n  if (!confirm('确定要删除这个商品吗？')) {\r\n    return;\r\n  }\r\n  try {\r\n    const result = await apiClient(`/products/${id}`, 'DELETE');\r\n    if (result.code === 1) {\r\n      // 删除成功后重新加载列表\r\n      loadProducts();\r\n    } else {\r\n      error.value = result.msg;\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message;\r\n  }\r\n};\r\n\r\n// 组件挂载时加载数据\r\nonMounted(loadProducts);\r\n</script>\r\n\r\n<style scoped>\r\n.search-form { margin: 20px 0; background: #f9f9f9; padding: 15px; border-radius: 5px; }\r\n.search-form input, .search-form button { margin-right: 10px; }\r\n.add-button { text-decoration: none; background: #42b983; color: white; padding: 8px 12px; border-radius: 4px; }\r\ntable { width: 100%; border-collapse: collapse; margin-top: 20px; }\r\nth, td { border: 1px solid #ddd; padding: 8px; }\r\nth { background-color: #f4f4f4; }\r\n.delete-button { background: #e74c3c; color: white; border: none; padding: 5px; cursor: pointer; margin-left: 10px; }\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}