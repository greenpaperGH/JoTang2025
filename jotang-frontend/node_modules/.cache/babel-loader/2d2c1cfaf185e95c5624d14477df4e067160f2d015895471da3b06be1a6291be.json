{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"form-group\"\n};\nconst _hoisted_2 = {\n  class: \"form-group\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"fieldset\", null, [_cache[10] || (_cache[10] = _createElementVNode(\"legend\", null, \"1. 认证 (Auth)\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_1, [_cache[7] || (_cache[7] = _createElementVNode(\"h3\", null, \"注册\", -1 /* CACHED */)), _createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleSignup, [\"prevent\"])\n  }, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.signupData.username = $event),\n    placeholder: \"用户名\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.signupData.username]]), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.signupData.password = $event),\n    placeholder: \"密码\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.signupData.password]]), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.signupData.role = $event),\n    placeholder: \"角色 (e.g., buyer)\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.signupData.role]]), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.signupData.phone = $event),\n    placeholder: \"电话\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.signupData.phone]]), _cache[6] || (_cache[6] = _createElementVNode(\"button\", {\n    type: \"submit\"\n  }, \"注册\", -1 /* CACHED */))], 32 /* NEED_HYDRATION */)]), _createElementVNode(\"div\", _hoisted_2, [_cache[9] || (_cache[9] = _createElementVNode(\"h3\", null, \"登录\", -1 /* CACHED */)), _createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleLogin, [\"prevent\"])\n  }, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.loginData.username = $event),\n    placeholder: \"用户名\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.loginData.username]]), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $setup.loginData.password = $event),\n    placeholder: \"密码\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.loginData.password]]), _cache[8] || (_cache[8] = _createElementVNode(\"button\", {\n    type: \"submit\"\n  }, \"登录\", -1 /* CACHED */))], 32 /* NEED_HYDRATION */)])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_createElementVNode","_hoisted_1","onSubmit","_withModifiers","$setup","handleSignup","type","signupData","username","$event","placeholder","required","password","role","phone","_hoisted_2","handleLogin","loginData"],"sources":["G:\\vue-project\\jotang-frontend\\src\\views\\AuthView.vue"],"sourcesContent":["<template>\r\n    <fieldset>\r\n        <legend>1. 认证 (Auth)</legend>\r\n        <div class=\"form-group\">\r\n            <h3>注册</h3>\r\n            <form @submit.prevent=\"handleSignup\">\r\n                <input type=\"text\" v-model=\"signupData.username\" placeholder=\"用户名\" required>\r\n                <input type=\"password\" v-model=\"signupData.password\" placeholder=\"密码\" required>\r\n                <input type=\"text\" v-model=\"signupData.role\" placeholder=\"角色 (e.g., buyer)\" required>\r\n                <input type=\"text\" v-model=\"signupData.phone\" placeholder=\"电话\" required>\r\n                <button type=\"submit\">注册</button>\r\n            </form>\r\n        </div>\r\n        <div class=\"form-group\">\r\n            <h3>登录</h3>\r\n            <form @submit.prevent=\"handleLogin\">\r\n                <input type=\"text\" v-model=\"loginData.username\" placeholder=\"用户名\" required>\r\n                <input type=\"password\" v-model=\"loginData.password\" placeholder=\"密码\" required>\r\n                <button type=\"submit\">登录</button>\r\n            </form>\r\n        </div>\r\n    </fieldset>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { apiFetch, login } from '@/services/apiService.js'\r\nimport { useAuth } from '@/store/auth.js'\r\n\r\n// 定义要 emit (发出) 的事件\r\nconst emit = defineEmits(['response'])\r\n\r\nconst { saveToken } = useAuth()\r\n\r\n// 注册表单数据\r\nconst signupData = ref({\r\n    username: '',\r\n    password: '',\r\n    role: '',\r\n    phone: ''\r\n})\r\n\r\n// 登录表单数据\r\nconst loginData = ref({\r\n    username: '',\r\n    password: ''\r\n})\r\n\r\n// 处理注册\r\nasync function handleSignup() {\r\n    try {\r\n        const result = await apiFetch('/signup', {\r\n            method: 'POST',\r\n            body: JSON.stringify(signupData.value),\r\n        })\r\n        emit('response', result)\r\n        // 清空表单\r\n        signupData.value = { username: '', password: '', role: '', phone: '' }\r\n    } catch (error) {\r\n        emit('response', { code: 0, msg: error.message, data: null })\r\n    }\r\n}\r\n\r\n// 处理登录\r\nasync function handleLogin() {\r\n    try {\r\n        // 使用特殊的 login 函数\r\n        const result = await login(loginData.value.username, loginData.value.password)\r\n        \r\n        // 登录成功 (result.code === 1)，保存 token\r\n        saveToken(result.data) \r\n        \r\n        emit('response', result)\r\n        // 清空表单\r\n        loginData.value = { username: '', password: '' }\r\n    } catch (error) {\r\n        emit('response', { code: 0, msg: error.message, data: null })\r\n    }\r\n}\r\n</script>"],"mappings":";;EAGaA,KAAK,EAAC;AAAY;;EAUlBA,KAAK,EAAC;AAAY;;uBAZ3BC,mBAAA,CAoBW,mB,4BAnBPC,mBAAA,CAA6B,gBAArB,cAAY,qBACpBA,mBAAA,CASM,OATNC,UASM,G,0BARFD,mBAAA,CAAW,YAAP,IAAE,qBACNA,mBAAA,CAMO;IANAE,QAAM,EAAAC,cAAA,CAAUC,MAAA,CAAAC,YAAY;sBAC/BL,mBAAA,CAA4E;IAArEM,IAAI,EAAC,MAAM;+DAAUF,MAAA,CAAAG,UAAU,CAACC,QAAQ,GAAAC,MAAA;IAAEC,WAAW,EAAC,KAAK;IAACC,QAAQ,EAAR;iDAAvCP,MAAA,CAAAG,UAAU,CAACC,QAAQ,E,mBAC/CR,mBAAA,CAA+E;IAAxEM,IAAI,EAAC,UAAU;+DAAUF,MAAA,CAAAG,UAAU,CAACK,QAAQ,GAAAH,MAAA;IAAEC,WAAW,EAAC,IAAI;IAACC,QAAQ,EAAR;iDAAtCP,MAAA,CAAAG,UAAU,CAACK,QAAQ,E,mBACnDZ,mBAAA,CAAqF;IAA9EM,IAAI,EAAC,MAAM;+DAAUF,MAAA,CAAAG,UAAU,CAACM,IAAI,GAAAJ,MAAA;IAAEC,WAAW,EAAC,kBAAkB;IAACC,QAAQ,EAAR;iDAAhDP,MAAA,CAAAG,UAAU,CAACM,IAAI,E,mBAC3Cb,mBAAA,CAAwE;IAAjEM,IAAI,EAAC,MAAM;+DAAUF,MAAA,CAAAG,UAAU,CAACO,KAAK,GAAAL,MAAA;IAAEC,WAAW,EAAC,IAAI;IAACC,QAAQ,EAAR;iDAAnCP,MAAA,CAAAG,UAAU,CAACO,KAAK,E,6BAC5Cd,mBAAA,CAAiC;IAAzBM,IAAI,EAAC;EAAQ,GAAC,IAAE,oB,8BAGhCN,mBAAA,CAOM,OAPNe,UAOM,G,0BANFf,mBAAA,CAAW,YAAP,IAAE,qBACNA,mBAAA,CAIO;IAJAE,QAAM,EAAAC,cAAA,CAAUC,MAAA,CAAAY,WAAW;sBAC9BhB,mBAAA,CAA2E;IAApEM,IAAI,EAAC,MAAM;+DAAUF,MAAA,CAAAa,SAAS,CAACT,QAAQ,GAAAC,MAAA;IAAEC,WAAW,EAAC,KAAK;IAACC,QAAQ,EAAR;iDAAtCP,MAAA,CAAAa,SAAS,CAACT,QAAQ,E,mBAC9CR,mBAAA,CAA8E;IAAvEM,IAAI,EAAC,UAAU;+DAAUF,MAAA,CAAAa,SAAS,CAACL,QAAQ,GAAAH,MAAA;IAAEC,WAAW,EAAC,IAAI;IAACC,QAAQ,EAAR;iDAArCP,MAAA,CAAAa,SAAS,CAACL,QAAQ,E,6BAClDZ,mBAAA,CAAiC;IAAzBM,IAAI,EAAC;EAAQ,GAAC,IAAE,oB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}