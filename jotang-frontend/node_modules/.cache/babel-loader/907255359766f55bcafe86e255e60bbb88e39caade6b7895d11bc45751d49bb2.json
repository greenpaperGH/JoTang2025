{"ast":null,"code":"import { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  key: 0\n};\nconst _hoisted_2 = {\n  key: 1\n};\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = {\n  type: \"submit\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  style: {\n    \"color\": \"red\"\n  }\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", null, [$setup.isEditMode ? (_openBlock(), _createElementBlock(\"h2\", _hoisted_1, \"编辑商品\")) : (_openBlock(), _createElementBlock(\"h2\", _hoisted_2, \"添加新商品\")), _createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleSubmit, [\"prevent\"])\n  }, [_createElementVNode(\"div\", null, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    for: \"title\"\n  }, \"标题:\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.product.title = $event),\n    id: \"title\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.product.title]])]), _createElementVNode(\"div\", null, [_cache[7] || (_cache[7] = _createElementVNode(\"label\", {\n    for: \"description\"\n  }, \"描述:\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.product.description = $event),\n    id: \"description\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.product.description]])]), _createElementVNode(\"div\", null, [_cache[8] || (_cache[8] = _createElementVNode(\"label\", {\n    for: \"type\"\n  }, \"类型:\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.product.type = $event),\n    id: \"type\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.product.type]])]), _createElementVNode(\"div\", null, [_cache[9] || (_cache[9] = _createElementVNode(\"label\", {\n    for: \"price\"\n  }, \"价格:\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"number\",\n    step: \"0.01\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.product.price = $event),\n    id: \"price\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.product.price, void 0, {\n    number: true\n  }]])]), _createElementVNode(\"div\", null, [_cache[10] || (_cache[10] = _createElementVNode(\"label\", {\n    for: \"status\"\n  }, \"状态:\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.product.status = $event),\n    id: \"status\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.product.status]])]), !$setup.isEditMode ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_cache[11] || (_cache[11] = _createElementVNode(\"label\", {\n    for: \"publisherId\"\n  }, \"发布者 ID:\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"number\",\n    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $setup.product.publisherId = $event),\n    id: \"publisherId\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.product.publisherId, void 0, {\n    number: true\n  }]])])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"button\", _hoisted_4, _toDisplayString($setup.isEditMode ? '更新' : '创建'), 1 /* TEXT */), $setup.error ? (_openBlock(), _createElementBlock(\"p\", _hoisted_5, _toDisplayString($setup.error), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)], 32 /* NEED_HYDRATION */)]);\n}","map":{"version":3,"names":["type","style","_createElementBlock","$setup","isEditMode","_hoisted_1","_hoisted_2","_createElementVNode","onSubmit","_withModifiers","handleSubmit","for","product","title","$event","id","required","description","step","price","number","status","_hoisted_3","publisherId","_hoisted_4","_toDisplayString","error","_hoisted_5"],"sources":["G:\\vue-project\\jotang-frontend\\src\\views\\ProductForm.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <h2 v-if=\"isEditMode\">编辑商品</h2>\r\n    <h2 v-else>添加新商品</h2>\r\n    \r\n    <form @submit.prevent=\"handleSubmit\">\r\n      <div>\r\n        <label for=\"title\">标题:</label>\r\n        <input type=\"text\" v-model=\"product.title\" id=\"title\" required>\r\n      </div>\r\n      <div>\r\n        <label for=\"description\">描述:</label>\r\n        <textarea v-model=\"product.description\" id=\"description\"></textarea>\r\n      </div>\r\n      <div>\r\n        <label for=\"type\">类型:</label>\r\n        <input type=\"text\" v-model=\"product.type\" id=\"type\" required>\r\n      </div>\r\n      <div>\r\n        <label for=\"price\">价格:</label>\r\n        <input type=\"number\" step=\"0.01\" v-model.number=\"product.price\" id=\"price\" required>\r\n      </div>\r\n      <div>\r\n        <label for=\"status\">状态:</label>\r\n        <input type=\"text\" v-model=\"product.status\" id=\"status\" required>\r\n      </div>\r\n      <div v-if=\"!isEditMode\">\r\n        <label for=\"publisherId\">发布者 ID:</label>\r\n        <input type=\"number\" v-model.number=\"product.publisherId\" id=\"publisherId\" required>\r\n      </div>\r\n      \r\n      <button type=\"submit\">{{ isEditMode ? '更新' : '创建' }}</button>\r\n      <p v-if=\"error\" style=\"color: red;\">{{ error }}</p>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, computed, defineProps } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport apiClient from '@/services/apiClient';\r\n\r\n// 从路由获取 props (在 router/index.js 中定义了 props: true)\r\nconst props = defineProps({\r\n  id: {\r\n    type: String,\r\n    default: null\r\n  }\r\n});\r\n\r\nconst router = useRouter();\r\nconst product = reactive({\r\n  id: null,\r\n  title: '',\r\n  description: '',\r\n  type: '',\r\n  price: 0.0,\r\n  status: 'available',\r\n  publisherId: null \r\n});\r\nconst error = ref(null);\r\n\r\n// 计算属性，判断当前是编辑模式还是新建模式\r\nconst isEditMode = computed(() => !!props.id);\r\n\r\n// (GET /products/{id})\r\nconst loadProductData = async () => {\r\n  if (!isEditMode.value) return; // 如果是新建模式，则跳过加载\r\n  try {\r\n    const result = await apiClient(`/products/${props.id}`, 'GET');\r\n    if (result.code === 1) {\r\n      // 将获取到的数据填充到表单\r\n      Object.assign(product, result.data);\r\n    } else {\r\n      error.value = result.msg;\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message;\r\n  }\r\n};\r\n\r\n// 提交表单 (POST /products 或 PUT /products)\r\nconst handleSubmit = async () => {\r\n  error.value = null;\r\n  try {\r\n    let result;\r\n    if (isEditMode.value) {\r\n      // 更新 (PUT)\r\n      result = await apiClient('/products', 'PUT', product);\r\n    } else {\r\n      // 创建 (POST)\r\n      result = await apiClient('/products', 'POST', product);\r\n    }\r\n\r\n    if (result.code === 1) {\r\n      router.push({ name: 'ProductList' }); // 成功后返回列表页\r\n    } else {\r\n      error.value = result.msg;\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message;\r\n  }\r\n};\r\n\r\n// 组件挂载时，如果是编辑模式，则加载商品数据\r\nonMounted(loadProductData);\r\n</script>"],"mappings":";;;;;;;;;;;EA+BcA,IAAI,EAAC;AAAQ;;;EACLC,KAAmB,EAAnB;IAAA;EAAA;;;uBA/BpBC,mBAAA,CAiCM,cAhCMC,MAAA,CAAAC,UAAU,I,cAApBF,mBAAA,CAA+B,MAAAG,UAAA,EAAT,MAAI,M,cAC1BH,mBAAA,CAAqB,MAAAI,UAAA,EAAV,OAAK,IAEhBC,mBAAA,CA4BO;IA5BAC,QAAM,EAAAC,cAAA,CAAUN,MAAA,CAAAO,YAAY;MACjCH,mBAAA,CAGM,c,0BAFJA,mBAAA,CAA8B;IAAvBI,GAAG,EAAC;EAAO,GAAC,KAAG,qB,gBACtBJ,mBAAA,CAA+D;IAAxDP,IAAI,EAAC,MAAM;+DAAUG,MAAA,CAAAS,OAAO,CAACC,KAAK,GAAAC,MAAA;IAAEC,EAAE,EAAC,OAAO;IAACC,QAAQ,EAAR;iDAA1Bb,MAAA,CAAAS,OAAO,CAACC,KAAK,E,KAE3CN,mBAAA,CAGM,c,0BAFJA,mBAAA,CAAoC;IAA7BI,GAAG,EAAC;EAAa,GAAC,KAAG,qB,gBAC5BJ,mBAAA,CAAoE;+DAAjDJ,MAAA,CAAAS,OAAO,CAACK,WAAW,GAAAH,MAAA;IAAEC,EAAE,EAAC;iDAAxBZ,MAAA,CAAAS,OAAO,CAACK,WAAW,E,KAExCV,mBAAA,CAGM,c,0BAFJA,mBAAA,CAA6B;IAAtBI,GAAG,EAAC;EAAM,GAAC,KAAG,qB,gBACrBJ,mBAAA,CAA6D;IAAtDP,IAAI,EAAC,MAAM;+DAAUG,MAAA,CAAAS,OAAO,CAACZ,IAAI,GAAAc,MAAA;IAAEC,EAAE,EAAC,MAAM;IAACC,QAAQ,EAAR;iDAAxBb,MAAA,CAAAS,OAAO,CAACZ,IAAI,E,KAE1CO,mBAAA,CAGM,c,0BAFJA,mBAAA,CAA8B;IAAvBI,GAAG,EAAC;EAAO,GAAC,KAAG,qB,gBACtBJ,mBAAA,CAAoF;IAA7EP,IAAI,EAAC,QAAQ;IAACkB,IAAI,EAAC,MAAM;+DAAiBf,MAAA,CAAAS,OAAO,CAACO,KAAK,GAAAL,MAAA;IAAEC,EAAE,EAAC,OAAO;IAACC,QAAQ,EAAR;iDAA1Bb,MAAA,CAAAS,OAAO,CAACO,KAAK,E;IAArBC,MAAM,EAAd;EAA8B,E,MAEjEb,mBAAA,CAGM,c,4BAFJA,mBAAA,CAA+B;IAAxBI,GAAG,EAAC;EAAQ,GAAC,KAAG,qB,gBACvBJ,mBAAA,CAAiE;IAA1DP,IAAI,EAAC,MAAM;+DAAUG,MAAA,CAAAS,OAAO,CAACS,MAAM,GAAAP,MAAA;IAAEC,EAAE,EAAC,QAAQ;IAACC,QAAQ,EAAR;iDAA5Bb,MAAA,CAAAS,OAAO,CAACS,MAAM,E,MAEhClB,MAAA,CAAAC,UAAU,I,cAAtBF,mBAAA,CAGM,OAAAoB,UAAA,G,4BAFJf,mBAAA,CAAwC;IAAjCI,GAAG,EAAC;EAAa,GAAC,SAAO,qB,gBAChCJ,mBAAA,CAAoF;IAA7EP,IAAI,EAAC,QAAQ;+DAAiBG,MAAA,CAAAS,OAAO,CAACW,WAAW,GAAAT,MAAA;IAAEC,EAAE,EAAC,aAAa;IAACC,QAAQ,EAAR;iDAAtCb,MAAA,CAAAS,OAAO,CAACW,WAAW,E;IAA3BH,MAAM,EAAd;EAAoC,E,2CAG3Db,mBAAA,CAA6D,UAA7DiB,UAA6D,EAAAC,gBAAA,CAApCtB,MAAA,CAAAC,UAAU,gCAC1BD,MAAA,CAAAuB,KAAK,I,cAAdxB,mBAAA,CAAmD,KAAnDyB,UAAmD,EAAAF,gBAAA,CAAZtB,MAAA,CAAAuB,KAAK,oB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}