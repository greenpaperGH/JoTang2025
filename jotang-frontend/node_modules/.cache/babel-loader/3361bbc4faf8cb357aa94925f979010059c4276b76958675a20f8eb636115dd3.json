{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  style: {\n    \"color\": \"red\"\n  }\n};\nimport { ref } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { useAuth } from '@/utils/auth';\nimport apiClient from '@/services/apiClient';\nexport default {\n  __name: 'LoginView',\n  setup(__props) {\n    const username = ref('');\n    const password = ref('');\n    const error = ref(null);\n    const router = useRouter();\n    const {\n      saveToken\n    } = useAuth();\n    const handleSubmit = async () => {\n      error.value = null;\n      try {\n        // 对应 LoginController 的 x-www-form-urlencoded\n        const formData = {\n          username: username.value,\n          password: password.value\n        };\n        const result = await apiClient('/login', 'POST', formData);\n        if (result.code === 1 && result.data) {\n          saveToken(result.data); // result.data 是 JWT\n          router.push({\n            name: 'ProductList'\n          }); // 登录成功，跳转到商品页\n        } else {\n          error.value = result.msg || '登录失败。';\n        }\n      } catch (err) {\n        error.value = err.message || '发生错误。';\n      }\n    };\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", null, [_cache[5] || (_cache[5] = _createElementVNode(\"h2\", null, \"登录\", -1)), _createElementVNode(\"form\", {\n        onSubmit: _withModifiers(handleSubmit, [\"prevent\"])\n      }, [_createElementVNode(\"div\", null, [_cache[2] || (_cache[2] = _createElementVNode(\"label\", {\n        for: \"username\"\n      }, \"用户名:\", -1)), _withDirectives(_createElementVNode(\"input\", {\n        type: \"text\",\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => username.value = $event),\n        id: \"username\",\n        required: \"\"\n      }, null, 512), [[_vModelText, username.value]])]), _createElementVNode(\"div\", null, [_cache[3] || (_cache[3] = _createElementVNode(\"label\", {\n        for: \"password\"\n      }, \"密码:\", -1)), _withDirectives(_createElementVNode(\"input\", {\n        type: \"password\",\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => password.value = $event),\n        id: \"password\",\n        required: \"\"\n      }, null, 512), [[_vModelText, password.value]])]), _cache[4] || (_cache[4] = _createElementVNode(\"button\", {\n        type: \"submit\"\n      }, \"登录\", -1)), error.value ? (_openBlock(), _createElementBlock(\"p\", _hoisted_1, _toDisplayString(error.value), 1)) : _createCommentVNode(\"\", true)], 32)]);\n    };\n  }\n};","map":{"version":3,"names":["ref","useRouter","useAuth","apiClient","username","password","error","router","saveToken","handleSubmit","value","formData","result","code","data","push","name","msg","err","message","_createElementBlock","_createElementVNode","onSubmit","_withModifiers","for","type","$event","id","required","_hoisted_1","_toDisplayString"],"sources":["G:/vue-project/jotang-frontend/src/views/LoginView.vue","G:\\vue-project\\jotang-frontend\\src\\views\\LoginView.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <h2>登录</h2>\r\n    <form @submit.prevent=\"handleSubmit\">\r\n      <div>\r\n        <label for=\"username\">用户名:</label>\r\n        <input type=\"text\" v-model=\"username\" id=\"username\" required>\r\n      </div>\r\n      <div>\r\n        <label for=\"password\">密码:</label>\r\n        <input type=\"password\" v-model=\"password\" id=\"password\" required>\r\n      </div>\r\n      <button type=\"submit\">登录</button>\r\n      <p v-if=\"error\" style=\"color: red;\">{{ error }}</p>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport { useAuth } from '@/utils/auth';\r\nimport apiClient from '@/services/apiClient';\r\n\r\nconst username = ref('');\r\nconst password = ref('');\r\nconst error = ref(null);\r\n\r\nconst router = useRouter();\r\nconst { saveToken } = useAuth();\r\n\r\nconst handleSubmit = async () => {\r\n  error.value = null;\r\n  try {\r\n    // 对应 LoginController 的 x-www-form-urlencoded\r\n    const formData = {\r\n      username: username.value,\r\n      password: password.value\r\n    };\r\n    \r\n    const result = await apiClient('/login', 'POST', formData);\r\n\r\n    if (result.code === 1 && result.data) {\r\n      saveToken(result.data); // result.data 是 JWT\r\n      router.push({ name: 'ProductList' }); // 登录成功，跳转到商品页\r\n    } else {\r\n      error.value = result.msg || '登录失败。';\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message || '发生错误。';\r\n  }\r\n};\r\n</script>","<template>\r\n  <div>\r\n    <h2>登录</h2>\r\n    <form @submit.prevent=\"handleSubmit\">\r\n      <div>\r\n        <label for=\"username\">用户名:</label>\r\n        <input type=\"text\" v-model=\"username\" id=\"username\" required>\r\n      </div>\r\n      <div>\r\n        <label for=\"password\">密码:</label>\r\n        <input type=\"password\" v-model=\"password\" id=\"password\" required>\r\n      </div>\r\n      <button type=\"submit\">登录</button>\r\n      <p v-if=\"error\" style=\"color: red;\">{{ error }}</p>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport { useAuth } from '@/utils/auth';\r\nimport apiClient from '@/services/apiClient';\r\n\r\nconst username = ref('');\r\nconst password = ref('');\r\nconst error = ref(null);\r\n\r\nconst router = useRouter();\r\nconst { saveToken } = useAuth();\r\n\r\nconst handleSubmit = async () => {\r\n  error.value = null;\r\n  try {\r\n    // 对应 LoginController 的 x-www-form-urlencoded\r\n    const formData = {\r\n      username: username.value,\r\n      password: password.value\r\n    };\r\n    \r\n    const result = await apiClient('/login', 'POST', formData);\r\n\r\n    if (result.code === 1 && result.data) {\r\n      saveToken(result.data); // result.data 是 JWT\r\n      router.push({ name: 'ProductList' }); // 登录成功，跳转到商品页\r\n    } else {\r\n      error.value = result.msg || '登录失败。';\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message || '发生错误。';\r\n  }\r\n};\r\n</script>"],"mappings":";;;;;;;;AAmBA,SAASA,GAAG,QAAQ,KAAK;AACzB,SAASC,SAAS,QAAQ,YAAY;AACtC,SAASC,OAAO,QAAQ,cAAc;AACtC,OAAOC,SAAS,MAAM,sBAAsB;;;;IAE5C,MAAMC,QAAQ,GAAGJ,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMK,QAAQ,GAAGL,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMM,KAAK,GAAGN,GAAG,CAAC,IAAI,CAAC;IAEvB,MAAMO,MAAM,GAAGN,SAAS,CAAC,CAAC;IAC1B,MAAM;MAAEO;IAAU,CAAC,GAAGN,OAAO,CAAC,CAAC;IAE/B,MAAMO,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/BH,KAAK,CAACI,KAAK,GAAG,IAAI;MAClB,IAAI;QACF;QACA,MAAMC,QAAQ,GAAG;UACfP,QAAQ,EAAEA,QAAQ,CAACM,KAAK;UACxBL,QAAQ,EAAEA,QAAQ,CAACK;QACrB,CAAC;QAED,MAAME,MAAM,GAAG,MAAMT,SAAS,CAAC,QAAQ,EAAE,MAAM,EAAEQ,QAAQ,CAAC;QAE1D,IAAIC,MAAM,CAACC,IAAI,KAAK,CAAC,IAAID,MAAM,CAACE,IAAI,EAAE;UACpCN,SAAS,CAACI,MAAM,CAACE,IAAI,CAAC,CAAC,CAAC;UACxBP,MAAM,CAACQ,IAAI,CAAC;YAAEC,IAAI,EAAE;UAAc,CAAC,CAAC,CAAC,CAAC;QACxC,CAAC,MAAM;UACLV,KAAK,CAACI,KAAK,GAAGE,MAAM,CAACK,GAAG,IAAI,OAAO;QACrC;MACF,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZZ,KAAK,CAACI,KAAK,GAAGQ,GAAG,CAACC,OAAO,IAAI,OAAO;MACtC;IACF,CAAC;;2BClDCC,mBAAA,CAcM,c,0BAbJC,mBAAA,CAAW,YAAP,IAAE,QACNA,mBAAA,CAWO;QAXAC,QAAM,EAAAC,cAAA,CAAUd,YAAY;UACjCY,mBAAA,CAGM,c,0BAFJA,mBAAA,CAAkC;QAA3BG,GAAG,EAAC;MAAU,GAAC,MAAI,Q,gBAC1BH,mBAAA,CAA6D;QAAtDI,IAAI,EAAC,MAAM;mEAAUrB,QAAQ,CAAAM,KAAA,GAAAgB,MAAA;QAAEC,EAAE,EAAC,UAAU;QAACC,QAAQ,EAAR;oCAAxBxB,QAAA,CAAAM,KAAQ,E,KAEtCW,mBAAA,CAGM,c,0BAFJA,mBAAA,CAAiC;QAA1BG,GAAG,EAAC;MAAU,GAAC,KAAG,Q,gBACzBH,mBAAA,CAAiE;QAA1DI,IAAI,EAAC,UAAU;mEAAUpB,QAAQ,CAAAK,KAAA,GAAAgB,MAAA;QAAEC,EAAE,EAAC,UAAU;QAACC,QAAQ,EAAR;oCAAxBvB,QAAA,CAAAK,KAAQ,E,+BAE1CW,mBAAA,CAAiC;QAAzBI,IAAI,EAAC;MAAQ,GAAC,IAAE,QACfnB,KAAA,CAAAI,KAAK,I,cAAdU,mBAAA,CAAmD,KAAnDS,UAAmD,EAAAC,gBAAA,CAAZxB,KAAA,CAAAI,KAAK,S","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}